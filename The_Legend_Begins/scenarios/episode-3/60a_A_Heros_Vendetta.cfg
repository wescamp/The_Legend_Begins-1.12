#textdomain wesnoth-The_Legend_Begins

[scenario]
    id="60a_A_Heros_Vendetta"
    name= _ "A Hero's Vendetta"
    map_data="{~add-ons/The_Legend_Begins/maps/episode-3/60a_A_Heros_Vendetta.map}"

    victory_when_enemies_defeated=yes
    next_scenario="60b_Swamp_of_Evil"

    {DEFAULT_MUSIC_PLAYLIST}

    # You are well away from the Blood Sky's influence

    {DEFAULT_SCHEDULE_RAIN_SET}
    {TLB_WEATHER_NORMAL_RAIN}
    {KNIGHTHOOD_GRANTING_MACRO}

    {TURNS 45 42 40}
    {TIME_OVER_DEFEAT}

    {~add-ons/The_Legend_Begins/macros/deaths.cfg}
    {~add-ons/The_Legend_Begins/macros/recurring-events.cfg}
    {~add-ons/The_Legend_Begins/macros/custom-advancement.cfg}

# You can have a maximum of 28 units - including your hero units

    {TLB_LIMIT_ARMY 1 (race=human) (Infantryman,Bowman,Spearman) 6 "human_troops"}
    {TLB_LIMIT_ARMY 1 (race=dwarf) (Dwarvish Fighter,Dwarvish Thunderer,Dwarvish Scout,Dwarvish Guardsman,Dwarvish Ulfserker) 6 "dwarven_troops"}
    {TLB_LIMIT_ARMY 1 (race=gryphon) (Gryphon Rider) 3 "gryphons"}
    {TLB_LIMIT_ARMY 1 (race=troll) (Troll Whelp) 3 "trolls"}
    {TLB_LIMIT_ARMY 1 (race=aberration) (Unhatched,Scornful Watcher,Black Cat) 4 "aberrations"}
    {TLB_LIMIT_ARMY 1 (race=nightmare) (Life Thief,Howling Darkness) 4 "nightmares"}

    [story]
        [part]
            music="loyalists.ogg"
            story= _ "After plundering the vampire cities, the army of the Alliance divided into two battalions and went their separate ways. After a day of hiking hills, Jahin and his army approached mountainous terrain. Since his cavalry and heavy infantry would never be able to get pass this terrain, Jahin sent Fairuz, Shifti and Ashhab with his heavy infantry and cavalry as well as his orcish and goblin soldiers as reinforcements for the southern battalion, whilst Jahin only took his light infantry and dwarves further north."
        [/part]
        [part]
           story= _ "With the help of the dwarven scouts, Jahin's army was able to cross the mountains and hills within three days. Then his army took a further four days to march through the hills and finally reach the edge of the desert. To Jahin's relief, he could see that the battle was being fought near his base camp..."
        [/part]
    [/story]

    [event]
        name="prestart"
        
        [recall]
            id="Fairuz"
        [/recall]
        [recall]
            id="Ashhab"
        [/recall]
        [recall]
            id="Shifti"
        [/recall]
        
        [store_unit]
            [filter]
                id="Fairuz"
            [/filter]
            kill=yes
            variable="stored.fairuz"
        [/store_unit]
        [store_unit]
            [filter]
                id="Ashhab"
            [/filter]
            kill=yes
            variable="stored.ashhab"
        [/store_unit]
        [store_unit]
            [filter]
                id="Shifti"
            [/filter]
            kill=yes
            variable="stored.shifti"
        [/store_unit]

        [store_unit]
            [filter]
                type="Glaiver,Heavy Infantryman,Cavalryman,Horseman,Shock Trooper,Knight,Dragoon,Lancer,Cavalier,Grand Knight,Iron Mauler,Orcish Grunt,Orcish Archer,Orcish Assassin,Wolf Rider,Orcish Warrior,Orcish Crossbowman,Orcish Slayer,Goblin Knight,Goblin Pillager,Direwolf Rider,Orcish Warlord,Orcish Slurbow,Orcish Nightblade"
            [/filter]
            kill=yes
            variable="stored.veterans"
        [/store_unit]

        [disallow_recruit]
            side=1
            type="Heavy Infantryman,Cavalryman,Horseman"
        [/disallow_recruit]

        [objectives]
            side=1
            [objective]
                description= _ "Defeat Comdr. Ashford (side 8 leader) with Jahin."
                condition="win"
            [/objective]
            [objective]
                description= _ "Reduce the Vampire army (Defeat all enemy leaders)."
                condition="win"
            [/objective]
            [objective]
                description= _ "Replenish your ranks (for later scenarios)."
                condition="win"
            [/objective]
            [objective]
                description= _ "Keep at least 500 gold by the end of this scenario."
                condition="win"
            [/objective]

            [objective]
                description= _ "Death of Jahin."
                condition="lose"
            [/objective]
            [objective]
                description= _ "Death of any hero unit."
                condition="lose"
            [/objective]
            [objective]
                description= _ "Death of an allied leader."
                condition="lose"
            [/objective]
            [objective]
                description= _ "Comdr. Ashford is killed by a unit other than Jahin."
                condition="lose"
            [/objective]
            {TURNS_RUN_OUT}

            [gold_carryover]
                 carryover_percentage=40
                 bonus=yes
            [/gold_carryover]

            [note]
                 description= _ "Each enemy leader slain by Jahin's army will grant a unique bonus such as, items, gold, weapons, loyal units, etc."
            [/note]
        [/objectives]

        [recall]
            id="Sreeyoshee"
        [/recall]
        [recall]
            id="Krog"
        [/recall]

        {VARIABLE key_found no}
        {CLEAR_VARIABLE fire,launch,random,catapult_coords}

        {SCATTER_UNITS 30 "Minotaur Gore,Minotaur Cutthroat,Minotaur Behemoth,Gnoll,Minotaur Savage,Minotaur Rouser,Minotaur Shaman" 2 (
		terrain=Gs^Ft
                x=8-35
                y=35-51

		[not]
			[filter]
			[/filter]
		[/not]

		[not]
			[filter_adjacent_location]
				[filter]
				[/filter]
			[/filter_adjacent_location]
		[/not]
	) (
		side=10
		generate_name=yes
		ai_special=guardian
		random_traits=yes
	)}

        [if]
           {VARIABLE_CONDITIONAL kran_kor_survived equals no}
           [then]
              [kill]
                  id="Kran Kor"
                  animate=no
              [/kill]
              [modify_side]
                  side=9
                  hidden=yes
              [/modify_side]
           [/then]
        [/if]

        {CLEAR_VARIABLE kran_kor_survived}

# You get a ring of HP for defeating side 7 leader

        {VARIABLE ring_hp_x 0}
        {VARIABLE ring_hp_y 0}

# You also get a heavy bow for defeating side 6 leader

        {VARIABLE took_bow no}
    [/event]

    [side]
        side=1
        team_name="good"
        user_team_name= _ "New Genesis"
        id="Jahin"
        name= _ "Jahin"
        type="Warmaster"
        controller=human
        canrecruit=yes
        {FLAG_VARIANT loyalist}
        {GOLD 250 200 200}
        {INCOME 5 4 3}
        village_gold=1
        recruit="Infantryman,Bowman,Cavalryman,Heavy Infantryman,Horseman,Spearman,Dwarvish Fighter,Dwarvish Thunderer,Dwarvish Scout,Dwarvish Ulfserker,Dwarvish Guardsman,Gryphon Rider,Troll Whelp,Unhatched,Scornful Watcher,Black Cat,Life Thief,Howling Darkness"
    [/side]

    {STARTING_VILLAGES 1 9}

    [side]
        side=2
        team_name="good"
        user_team_name= _ "Aragwaithi"
        id="Lord Warren"
        name= _ "Lord Warren"
        type="Aragwaith Ancient Banner"
        controller=ai
        canrecruit=yes
        {FLAG_VARIANT loyalist}
        {GOLD 550 500 500}
        recruit="Aragwaith Archer,Aragwaith Swordsman,Aragwaith Spearman,Aragwaith Guard,Aragwaith Strongbow,Aragwaith Scout,Aragwaith Eagle Rider"
        {INCOME 28 28 28}
        [ai]
           {AI_SIMPLE_ALWAYS_ASPECT time_of_day lawful}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.70}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=4
              [/criteria]
              value=20
           [/goal]
           [goal]
              name="target"
              [criteria]
                  side=5
              [/criteria]
              value=20
           [/goal]
        [/ai]
        [ai]
           {AI_SIMPLE_ALWAYS_ASPECT time_of_day chaotic}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT grouping defensive}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.30}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=4
              [/criteria]
              value=20
           [/goal]
           [goal]
              name="target"
              [criteria]
                  side=5
              [/criteria]
              value=20
           [/goal]
        [/ai]
   [/side]

   {STARTING_VILLAGES 2 8}

   [event]
       name="die"
       [filter]
           id="Lord Warren"
       [/filter]
       [message]
           speaker="Jahin"
           message= _ "Oh, no! We have loss a valuable ally! We're doomed!"
       [/message]
       [endlevel]
           result="defeat"
       [/endlevel]
   [/event]

   [side]
        side=3
        team_name="good"
        user_team_name= _ "Aragwaithi"
        id="Comdr. Sedoc"
        name= _ "Comdr. Sedoc"
        type="Aragwaith Captain"
        controller=ai
        canrecruit=yes
        {FLAG_VARIANT loyalist}
        {GOLD 550 500 500}
        recruit="Aragwaith Archer,Aragwaith Swordsman,Aragwaith Spearman,Aragwaith Guard,Aragwaith Strongbow,Aragwaith Scout,Aragwaith Eagle Rider"
        {INCOME 28 28 28}
        [ai]
           {AI_SIMPLE_ALWAYS_ASPECT time_of_day lawful}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.75}
           {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=6
              [/criteria]
              value=40
           [/goal]
           [goal]
              name="target"
              [criteria]
                  side=7
              [/criteria]
              value=40
           [/goal]
        [/ai]
        [ai]
           {AI_SIMPLE_ALWAYS_ASPECT time_of_day chaotic}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.35}
           {AI_SIMPLE_ALWAYS_ASPECT grouping defensive}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=6
              [/criteria]
              value=40
           [/goal]
           [goal]
              name="target"
              [criteria]
                  side=7
              [/criteria]
              value=40
           [/goal]
        [/ai]
   [/side]

   {STARTING_VILLAGES 3 8}

   [event]
       name="die"
       [filter]
           id="Comdr. Sedoc"
       [/filter]
       [message]
           speaker="Jahin"
           message= _ "Oh, no! We have loss a valuable ally! We're doomed!"
       [/message]
       [endlevel]
           result="defeat"
       [/endlevel]
   [/event]

   [side]
       side=4
       team_name="bad"
       user_team_name= _ "Vampires"
       id="Prince Laurent"
       name= _ "Prince Laurent"
       type="Methusalem"
       controller=ai
       canrecruit=yes
       {FLAG_VARIANT long}
       {GOLD 400 450 500}
       {INCOME 28 28 28}
       recruit="Fledgeling,Thin Blood,Blood Apprentice,Blood Hulk,Vampire Noble,Vampire Duelist,Sire,Sword Dancer,Half Blood,Blood Manipulator,Flesh Artisan,Mistress,Terror Hulk,Twilight Walker,Day Hunter,Vampiric Dread Bat"
       [ai]
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,mixed fighter,mixed fighter,archer,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.99}
           {AI_SIMPLE_ALWAYS_ASPECT grouping no}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=2
              [/criteria]
              value=40
           [/goal]
           [goal]
              name="target"
              [criteria]
                  side=1
              [/criteria]
              value=30
           [/goal]
        [/ai]
   [/side]

   {STARTING_VILLAGES 4 2}

   {LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Twilight Walker" 4}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Day Hunter" 4}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Sword Dancer" 4}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Sire" 2}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Mistress" 2}
   

# Although the key is useless now
# it will grant you access to a powerful broadsword
# in a later scenario...

   [event]
       name="die"
       [filter]
           id="Prince Laurent"
       [/filter]
       [filter_second]
           side=1
       [/filter_second]
       [message]
           speaker="Jahin"
           message= _ "Another member of the vampire Monarchy falls!"
       [/message]
       [message]
           speaker="second_unit"
           message= _ "Hey, I found a strange key in his robes. I'm keeping this for it may be useful to us later."
       [/message]
       {VARIABLE key_found yes}
   [/event]

   [event]
       name="die"
       [filter]
           id="Prince Laurent"
       [/filter]
       [filter_second]
           [not]
              side=1
           [/not]
       [/filter_second]
       [message]
           speaker="Jahin"
           message= _ "Another member of the vampire Monarchy falls!"
       [/message]
   [/event]

   [side]
       side=5
       team_name="bad"
       user_team_name= _ "Minotaurs"
       id="Tarif"
       name= _ "Tarif"
       type="Minotaur Overlord"
       canrecruit=yes
       controller=ai
       {GOLD 400 450 500}
       {INCOME 28 28 28}
       {FLAG_VARIANT ragged}
       recruit="Minotaur Gore,Minotaur Cutthroat,Minotaur Savage,Minotaur Rouser,Minotaur Slayer,Minotaur Shaman,Minotaur Mystic,Gnoll,Gnoll Marksman,Minotaur Overlord,Minotaur Behemoth,Minotaur Ancient Behemoth,Boar Rider,Boar Knight"
       [ai]
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,mixed fighter,mixed fighter,archer,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.99}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT grouping no}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=9
              [/criteria]
              value=40
           [/goal]
           [goal]
              name="target"
              [criteria]
                  side=2
              [/criteria]
              value=30
           [/goal]
        [/ai]
   [/side]

   {STARTING_VILLAGES 5 6}

   {LIMIT_CONTEMPORANEOUS_RECRUITS 5 "Minotaur Overlord" 4}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 5 "Minotaur Mystic" 4}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 5 "Boar Knight" 4}

   [event]
       name="die"
       [filter]
           id="Tarif"
       [/filter]
       [filter_second]
           [not]
              side=1
           [/not]
       [/filter_second]
       [message]
           speaker="second_unit"
           message= _ "Die you, beast!"
       [/message]
   [/event]

   [event]
       name="die"
       [filter]
           id="Tarif"
       [/filter]
       [filter_second]
              side=1
       [/filter_second]
       [message]
           speaker="second_unit"
           message= _ "Die you, beast!"
       [/message]

       {LOYAL_UNIT 1 "Minotaur Gore" 12 21}
       {LOYAL_UNIT 1 "Minotaur Rouser" 8 23}
       {LOYAL_UNIT 1 "Gnoll" 13 26}
       {LOYAL_UNIT 1 "Minotaur Shaman" 10 17}
       {LOYAL_UNIT 1 "Minotaur Cutthroat" 20 23}
       [+unit]
           id="Loyal"
       [/unit]

       [message]
           speaker="Krog"
           message= _ "Look, more cow-heads! Kill cow-heads!"
       [/message]

       [message]
           speaker="Loyal"
           message= _ "Wait,! We fight for you now!"
       [/message]
       [message]
           speaker="Jahin"
           message= _ "Why should I let you fight for me?"
       [/message]
       [message]
           speaker="Loyal"
           message= _ "We hated the vampires. They forced us into their wars."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "<i>(thinking)</i> I could always use more soldiers."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "Are you going to fight for free or is there any payment involved?"
       [/message]
       [message]
           speaker="Loyal"
           message= _ "Give us two hundred gold and we shall fight for you until our deaths."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "Let me think..."
          [option]
              message= _ "Pay 200 gold."
              [command]
                  [message]
                      speaker="Jahin"
                      message= _ "It's a deal!"
                  [/message]
                  [gold]
                     side=1
                     amount=-200
                  [/gold]
              [/command]
          [/option]
          [option]
              message= _ "Decline offer."
              [command]
                  [message]
                      speaker="Jahin"
                      message= _ "I'm sorry. I have enough soldiers with me already."
                  [/message]
                  [message]
                      speaker="Loyal"
                      message= _ "Suit yourself, human."
                  [/message]
                  [kill]
                      side=1
                      race=minotaur
                      animate=no
                  [/kill]
                  [kill]
                      side=1
                      race=gnoll
                      animate=no
                  [/kill]
              [/command]
          [/option]
      [/message]
   [/event]

   [side]
       side=6
       team_name="bad"
       user_team_name= _ "Vampires"
       id="Gabi"
       name= _ "Gabi"
       gender=female
       type="Twilight Walker"
       canrecruit=yes
       controller=ai
       {FLAG_VARIANT long}
       {GOLD 400 450 500}
       {INCOME 28 28 28}
       recruit="Fledgeling,Thin Blood,Half Blood,Vampire Duelist,Twilight Walker,Day Hunter,Gargoyle,Marlgoyle,Blood Manipulator,Blood Apprentice"
       [ai]
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,mixed fighter,mixed fighter,archer,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.99}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT grouping no}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=3
              [/criteria]
              value=40
           [/goal]
           [goal]
              name="target"
              [criteria]
                  side=1
              [/criteria]
              value=30
           [/goal]
        [/ai]
   [/side]

   {STARTING_VILLAGES 6 2}

   {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Twilight Walker" 4}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Day Hunter" 4}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Marlgoyle" 4}

   [event]
       name="die"
       [filter]
           id="Gabi"
       [/filter]
       [filter_second]
           [not]
              side=1
           [/not]
       [/filter_second]
       [message]
           speaker="second_unit"
           message= _ "Join your brethren in hell!"
       [/message]
   [/event]

   [event]
       name="die"
       [filter]
           id="Gabi"
       [/filter]
       [filter_second]
           side=1
       [/filter_second]
       [message]
           speaker="second_unit"
           message= _ "Hey, this vampire left a longbow before turning to ashes. It seems that this bow has been beautifully crafted. Should we take it?"
       [/message]
       [message]
           speaker="Comdr. Sedoc"
           message= _ "Maybe you could give it to that archer friend of yours. He might put it to good use."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "Thank for suggesting that, Commander. Affan would like this."
       [/message]
       {VARIABLE took_bow yes}
   [/event]

   [side]
       side=7
       team_name="bad"
       user_team_name= _ "Vampires"
       id="Princess Denisha"
       name= _ "Princess Denisha"
       gender=female
       type="Duchess"
       canrecruit=yes
       controller=ai
       {FLAG_VARIANT long}
       {AI_SIMPLE_ALWAYS_ASPECT grouping no}
       {GOLD 400 450 500}
       {INCOME 28 28 28}
       recruit="Fledgeling,Thin Blood,Half Blood,Vampire Duelist,Twilight Walker,Day Hunter,Gargoyle,Marlgoyle,Blood Manipulator,Blood Apprentice,Sword Dancer,Sire"
       [ai]
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,mixed fighter,mixed fighter,archer,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.99}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=3
              [/criteria]
              value=40
           [/goal]
           [goal]
              name="target"
              [criteria]
                  side=2
              [/criteria]
              value=30
           [/goal]
        [/ai]
   [/side]

   {STARTING_VILLAGES 7 2}

   {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Twilight Walker" 3}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Day Hunter" 3}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Sword Dancer" 4}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Sire" 2}
   {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Marlgoyle" 3}

   [event]
       name="die"
       [filter]
           id="Princess Denisha"
       [/filter]
       [filter_second]
           [not]
               side=1
           [/not]
       [/filter_second]
       [message]
           speaker="Jahin"
           message= _ "Another member of the Monarchy of Blood bites the dust!"
       [/message]
   [/event]

   [event]
       name="die"
       [filter]
           id="Princess Denisha"
       [/filter]
       [filter_second]
           side=1
       [/filter_second]
       
       [kill]
          id="Princess Denisha"
          animate=no
       [/kill]

       {VARIABLE ring_hp_x $x1}
       {VARIABLE ring_hp_y $y1}

       {PLACE_IMAGE "items/ring-red.png"  $x1 $y1}

       {DELAY 100}

       [message]
           speaker="second_unit"
           message= _ "Hey, she dropped a ring. Should we take it?"
       [/message]
   [/event]

   [event]
        name=moveto
        first_time_only=no

        [filter]
            side=1
            x,y=ring_hp_x,ring_hp_y
        [/filter]

        [if]
            [have_unit]
                x,y=ring_hp_x,ring_hp_y
                [not]
                   race=undead
                [/not]
                [not]
                   race=nightmare
                [/not]
                [not]
                   race=aberration
                [/not]
            [/have_unit]

            [variable]
                name=item_ring_picked_up
                not_equals=yes
            [/variable]

            [then]
                [message]
                    speaker=narrator
                    message= - "$unit.name has found a rare Ring of HP. Should he or she take it?"
                    image="wesnoth-icon.png"

                    [option]
                        message= _ "I'm gonna wear it..."

                        [command]
                            [object]
                                id="ring_of_HP"
                                name= _ "Ring of Vitality"
                                image="items/ring-red.png"

# Choose it's bearer carefully
# for the ring is worth 4 AMLAs

# Best Choice - Sreeyoshee
# 2nd Best Choice - Jahin
# Third Best Choice - any other unit.

                                description= _ "This ring grants the wearer +12 maximum HP."
                                [effect]
                                    apply_to=hitpoints
                                    increase_total=12
                                [/effect]
                            [/object]

                            [remove_item]
                                x,y=ring_hp_x,ring_hp_y
                            [/remove_item]

                            [set_variable]
                                name=item_ring_picked_up
                                value=yes
                            [/set_variable]
                        [/command]
                    [/option]

                    [option]
                        message= _ "Nah, someone better than me deserves it..."

                        [command]
                            [allow_undo]
                            [/allow_undo]
                        [/command]
                    [/option]
                [/message]
            [/then]

            [else]
                [if]
                    [variable]
                        name=item_ring_picked_up
                        not_equals=yes
                    [/variable]

                    [then]
                        [message]
                            speaker=narrator
                            message= _ "Only a living being may wear this trinket!"
                            image="wesnoth-icon.png"
                            side_for=$side_number
                            # the above is used to prevent an AI side from
                            # accidentally triggering this dialog
                        [/message]
                    [/then]
                [/if]

                [allow_undo]
                [/allow_undo]
            [/else]
        [/if]
    [/event]

    [event]
        name=victory

        [clear_variable]
            name=item_ring_picked_up
        [/clear_variable]
    [/event]

   [side]
       side=8
       team_name="bad"
       user_team_name= _ "Vampires"
       id="Comdr. Ashford"
       name= _ "Comdr. Ashford"
       type="Sire"
       canrecruit=yes
       controller=ai
       {FLAG_VARIANT long}
       {GOLD 300 350 400}
       {INCOME 28 28 28}
       recruit="Fledgeling,Thin Blood,Half Blood,Vampire Duelist,Gargoyle,Marlgoyle,Blood Manipulator,Blood Apprentice,Blood Hulk"
       [ai]
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,archer,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.99}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT grouping no}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {AI_SIMPLE_ALWAYS_ASPECT simple_targeting yes}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=1
              [/criteria]
              value=100
           [/goal]
    
        [/ai]
   [/side]

   {STARTING_VILLAGES 8 2}

   {LIMIT_CONTEMPORANEOUS_RECRUITS 8 "Marlgoyle" 3}

   [event]
       name="die"
       [filter]
           id="Comdr. Ashford"
       [/filter]
       [filter_second]
           [not]
              id="Jahin"
           [/not]
       [/filter_second]
       [message]
           speaker="Jahin"
           message= _ "Hey, I was suppose to kill him!"
       [/message]
       [endlevel]
           result="defeat"
       [/endlevel]
   [/event]

   [event]
       name="die"
       [filter]
           id="Comdr. Ashford"
       [/filter]
       [filter_second]
           id="Jahin"
       [/filter_second]
       [message]
           speaker="Jahin"
           message= _ "This is for my mother!"
       [/message]
       [message]
           speaker="narrator"
           image="wesnoth-icon.png"
           message= _ "The vampire commander's head is severed from his shoulders with one stroke of Jahin's broadsword."
       [/message]
       [message]
           speaker="Krog"
           message= _ "Look! Evil vampire hid gold!"
       [/message]
       {LOOT 800 1}
   [/event]

# Disallowed recruitment of Sky Drakes
# They suck and are a waste of gold

   [side]
       side=9
       team_name="good"
       user_team_name= _ "Drakes"
       {FLAG_VARIANT ragged}
       id="Kran Kor"
       name= _ "Kran Kor"
       type="Drake Blademaster"
       canrecruit=yes
       controller=ai
       {GOLD 200 180 150}
       {INCOME 13 13 13}
       [modifications]
           {TRAIT_AGED}
           {TRAIT_INTELLIGENT}
       [/modifications]
       recruit="Drake Burner,Fire Drake,Drake Fighter,Drake Warrior,Drake Clasher,Drake Thrasher,Drake Arbiter,Drake Flare"
       [ai]
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_pattern (fighter,fighter,fighter,mixed fighter,archer,archer,scout)}
           {AI_SIMPLE_ALWAYS_ASPECT aggression 0.80}
           {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
           {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
           {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
           {ATTACK_DEPTH 5 5 6}

           [goal]
              name="target"
              [criteria]
                  side=4
              [/criteria]
              value=800
           [/goal]
           [goal]
              name="target"
              [criteria]
                  side=10
              [/criteria]
              value=0.00
           [/goal]
    
        [/ai]
   [/side]

   [event]
       name="die"
       [filter]
           id="Kran Kor"
       [/filter]
       [message]
           speaker="Jahin"
           message= _ "Thank you, drake chief. I will never forget about your invaluable support."
       [/message]
   [/event]

   [side]
       side=10
       team_name="bad"
       color="pink"
       user_team_name= _ "Vampires"
       no_leader=yes
       gold=0
       income=-2
       hidden=yes
       {FLAG_VARIANT long}

       [ai]
         {AI_SIMPLE_ALWAYS_ASPECT aggression 0.80}
         {AI_SIMPLE_ALWAYS_ASPECT caution 0.40}
         {AI_SIMPLE_ALWAYS_ASPECT recruitment_ignore_bad_combat no}
         {ATTACK_DEPTH 5 5 6}
       [/ai]

       {GENERIC_UNIT 10 "Sire" 38 37}{GUARDIAN}
       {GENERIC_UNIT 10 "Mistress" 37 38}{GUARDIAN}
       {GENERIC_UNIT 10 "Sword Dancer" 39 38}{GUARDIAN}
       {GENERIC_UNIT 10 "Twilight Walker" 34 39}{GUARDIAN}
       {GENERIC_UNIT 10 "Day Hunter" 33 42}{GUARDIAN}
       {GENERIC_UNIT 10 "Terror Hulk" 33 43}{GUARDIAN}
       {GENERIC_UNIT 10 "Sangel" 34 45}{GUARDIAN}
       {GENERIC_UNIT 10 "Marlgoyle" 35 46}{GUARDIAN}
       {GENERIC_UNIT 10 "Sire" 35 47}{GUARDIAN}
       {GENERIC_UNIT 10 "Mistress" 42 38}{GUARDIAN}
       {GENERIC_UNIT 10 "Sword Dancer" 43 39}{GUARDIAN}
       {GENERIC_UNIT 10 "Twilight Walker" 43 37}{GUARDIAN}
       {GENERIC_UNIT 10 "Day Hunter" 44 37}{GUARDIAN}
       {GENERIC_UNIT 10 "Terror Hulk" 45 38}{GUARDIAN}
       {GENERIC_UNIT 10 "Sangel" 45 39}{GUARDIAN}
       {GENERIC_UNIT 10 "Marlgoyle" 47 41}{GUARDIAN}
       {GENERIC_UNIT 10 "Sire" 47 43}{GUARDIAN}
       {GENERIC_UNIT 10 "Mistress" 47 44}{GUARDIAN}
       {GENERIC_UNIT 10 "Sword Dancer" 40 41}{GUARDIAN}
       {GENERIC_UNIT 10 "Twilight Walker" 42 43}{GUARDIAN}
       {GENERIC_UNIT 10 "Day Hunter" 40 45}{GUARDIAN}
       {GENERIC_UNIT 10 "Terror Hulk" 38 43}{GUARDIAN}
       {GENERIC_UNIT 10 "Sangel" 46 25}{GUARDIAN}
       {GENERIC_UNIT 10 "Marlgoyle" 48 23}{GUARDIAN}
       {GENERIC_UNIT 10 "Sire" 47 24}{GUARDIAN}
       {GENERIC_UNIT 10 "Mistress" 47 27}{GUARDIAN}
       {GENERIC_UNIT 10 "Sword Dancer" 48 27}{GUARDIAN}
       {GENERIC_UNIT 10 "Twilight Walker" 3 26}{GUARDIAN}
       {GENERIC_UNIT 10 "Day Hunter" 5 26}{GUARDIAN}
       {GENERIC_UNIT 10 "Terror Hulk" 2 27}{GUARDIAN}
       {GENERIC_UNIT 10 "Sangel" 3 29}{GUARDIAN}
       {GENERIC_UNIT 10 "Marlgoyle" 5 29}{GUARDIAN}
       {GENERIC_UNIT 10 "Sire" 6 27}{GUARDIAN}
   [/side]

# To keep the battle raging on...

   [event]
       name="turn 8, turn 13, turn 18, turn 23, turn 28, turn 33, turn 38, turn 43, turn 48"
       first_time_only=no
       [gold]
          side=2
          amount=350
       [/gold]
       [gold]
          side=3
          amount=350
       [/gold]
       [gold]
          side=4
          amount=220
       [/gold]
       [gold]
          side=5
          amount=220
       [/gold]
       [gold]
          side=6
          amount=220
       [/gold]
       [gold]
          side=7
          amount=220
       [/gold]
       [gold]
          side=8
          amount=150
       [/gold]
       [gold]
          side=9
          amount=100
       [/gold]
   [/event]

   [event]
       name="enemies defeated"

       [message]
           speaker="Jahin"
           message= _ "Victory!"
       [/message]
       [message]
           speaker="Lord Warren"
           message= _ "Thank you, Jahin, for your invaluable support. We would not have lasted much longer if you had not intervened."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "We are always happy to help. But, before I forget, Lord Warren, do you have any soldiers who can steer ships? It turns out that the vampire capital city is beyond the seas and none of my men can navigate ships."
       [/message]
       [message]
           speaker="Lord Warren"
           message= _ "I have sailors, but they are all injured as well as the majority of my army. We cannot aid you in your battles anymore, at least, not until my soldiers have recovered their vitality."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "I understand your problems, Lord Warren. Farewell for now as my army and I shall head south and reinforce our allies there."
       [/message]
       [message]
           speaker="Lord Warren"
           message= _ "I wish you good luck on your coming battles, Jahin. Perhaps we shall meet again in happier times."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "Thank you, Lord Warren."
       [/message]
       [if]
          [have_unit]
              id="Kran Kor"
          [/have_unit]
          [then]
             [message]
                 speaker="Kran Kor"
                 message= _ "Wait, aren't you gonna pay us for our services?"
             [/message]
             [message]
                 speaker="Jahin"
                 message= _ "Oh, yes. How much do I have to pay?"
             [/message]
             [message]
                 speaker="Kran Kor"
                 message= _ "Five hundred gold coins."
             [/message]
             [message]
                 speaker="Jahin"
                 message= _ "Fine. Here you go."
             [/message]
             [sound]
                 name="gold.ogg"
             [/sound]
             [gold]
                 side=1
                 amount=-500
             [/gold]
          [/then]
       [/if]

       {CLEAR_VARIABLE kran_kor_survived}
       [endlevel]
           result="victory"
           {NEW_GOLD_CARRYOVER 40}
           bonus=yes
       [/endlevel]
   [/event]

   [event]
       name="start"
   
       [message]
           speaker="Jahin"
           message= _ "We have finally arrived! Set up camp here and let's get ready for battle."
       [/message]
       [message]
           speaker="Lord Warren"
           message= _ "Jahin, thank you for coming. Attack the fortress east of your location. Let us deal with their main army."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "As you wish, Lord Warren."
       [/message]

       {DELAY 200}
       [message]
           speaker="Comdr. Ashford"
           message= _ "Lord Laurent, we have enemies coming from the south!"
       [/message]
       [message]
           speaker="Prince Laurent"
           message= _ "They don't seem to be much of a problem. Kill them yourself."
       [/message]

       [scroll_to_unit]
           id="Comdr. Ashford"
       [/scroll_to_unit]
       {DELAY 400}
       [message]
           speaker="Jahin"
           message= _ "<i>(thinking)</i> Wait, that commander's face...I have seen that face before....No, it can't be...I must confirm it."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "Hey, you! Your face seems oddly familiar. Have you ever been to a vampire-occupied city southwest from here?"
       [/message]
       [message]
           speaker="Comdr. Ashford"
           message= _ "<i>(surprised)</i> Well, I was stationed as a captain in a city known as Genesis which lies in that direction."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "During your time as as captain, did you ever try to convert a person to your kind and that resulted in that certain person's demise?"
       [/message]
       [message]
           speaker="Comdr. Ashford"
           message= _ "Now, that you mention it; there was this woman, mother of six, that faced a fate like that. But, why are you so interested, human?"
       [/message]
       [message]
           speaker="Jahin"
           message= _ "How does that incident relate to me? Well, it's quite simple. That woman was my mother, you rotten, blood-sucking vampire! I never forgot that day and probably never will! What did she ever do to you?! Now, I shall have avenge her death! Soldiers of New Genesis, destroy that fortress but, leave that vermin to me. I shall dispose of him myself!"
       [/message]
   [/event]

   [event]
       name="turn 15"

       [message]
           speaker="Jahin"
           message= _ "No matter how strong the enemy is, they shall never break our spirits! Keep fighting, my fellow comrades"
       [/message]
       [message]
           speaker="Krog"
           message= _ "Krog smash vampires!"
       [/message]
   [/event]

   [event]
       name="turn 20"

       [message]
           speaker="Sreeyoshee"
           message= _ "Jahin, is extracting your vengeance mandatory? You don't have to do this. There is always another option - peace."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "No,  Sreeyoshee. That can never be. These vampires have done crimes that are unforgivable. They must be silenced; once and for all."
       [/message]
   [/event]

   [event]
       name="turn 10"
       
       [message]
           speaker="Jahin"
           message= _ "Prince Laurent, also known as the Champion of the Blood and the Second Eldest, I have hear a lot about you. Where was that legendary great-sword you always carry?"
       [/message]
       [message]
           speaker="Prince Laurent"
           message= _ "It feels good to hear that the enemy knows my identity. As for my sword, I left at my father's palace."
       [/message]
       [message]
           speaker="Jahin"
           message= _ "Oh, that's a shame. I wanted to take that sword home as a trophy when I had slain you. But, I guess I shall have to settle for your head instead!"
       [/message]
       [message]
           speaker="Prince Laurent"
           message= _ "<i>(laughing)</i> You make me laugh, human. I conquered the Celestial remnants and enslaved the Minotaur race. How can a mortal like you defeat me?"
       [/message]
       [message]
           speaker="Jahin"
           message= _ "We shall see soon enough!"
       [/message]
   [/event]

[/scenario]